function Vector3(a,c,b){this.x=a;this.y=c;this.z=b;return this}Vector3.prototype={add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this}};function Vector4(a,d,c,b){this.x=a;this.y=d;this.z=c;this.w=b;return this}Vector4.prototype={constructor:Vector4,add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w-=a.w;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;this.w/=a.w;return this},dot:function(a){return(this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w)},normalize:function(){return Math.sqrt(this.dot())},projection:function(b,a){var b=b||Game.viewport.width;var a=a||Game.viewport.height},toString:function(){return"N3D.Vector4("+this.x+","+this.y+","+this.z+","+this.w+")"}};function Matrix4a(m,k,i,g,f,e,d,c,b,a,p,o,n,l,j,h){if(h){this.m=([m,k,i,g,f,e,d,c,b,a,p,o,n,l,j,h]);return this}this.m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this}Matrix4a.prototype={constructor:Matrix4a,type:"Array",determinant:function(){var p=this.m[0],o=this.m[1],n=this.m[2],m=this.m[3],l=this.m[4],k=this.m[5],j=this.m[6],i=this.m[7],h=this.m[8],g=this.m[9],f=this.m[10],e=this.m[11],d=this.m[12],c=this.m[13],b=this.m[14],a=this.m[15];n0=k*(f*a-e*b-j*(g*a-e*c)+i*(g*b-f*c)),n4=l*(f*a-e*b)-j*(h*a-e*d)+i*(h*b-f*d),n8=l*(g*a-e*c)-k*(h*a-e*d)+i*(h*c-g*d),n12=l*(g*b-f*c)-k*(h*b-f*d)+j*(h*c-g*d);return(p*n0+o*n4-n*n8+m*n12)},inverse:function(){var d=this.m[0],c=this.m[1],b=this.m[2],a=this.m[3],u=this.m[4],t=this.m[5],r=this.m[6],p=this.m[7],n=this.m[8],l=this.m[9],s=this.m[10],q=this.m[11],o=this.m[12],m=this.m[13],k=this.m[14],j=this.m[15],h=t*(s*j-q*k-r*(l*j-q*m)+p*(l*k-s*m)),g=u*(s*j-q*k)-r*(n*j-q*o)+p*(n*k-s*o),f=u*(l*j-q*m)-t*(n*j-q*o)+p*(n*m-l*o),i=u*(l*k-s*m)-t*(n*k-s*o)+r*(n*m-l*o),e=1/(d*h+c*g-b*f+a*i);this.m=([h*e,-(c*(s*j-q*k)-b*(l*j-q*m)+a*(l*k-s*m))*e,(c*(r*j-p*k)-b*(t*j-p*m)+a*(t*k-r*m))*e,-(c*(r*q-p*s)-b*(t*q-p*l)+a*(t*s-r*l))*e,-g*e,(d*(s*j-q*k)-b*(n*j-q*o)+a*(n*k-s*o))*e,-(d*(r*j-p*k)-b*(u*j-p*o)+a*(u*k-r*o))*e,(d*(r*q-p*s)-b*(u*q-p*n)+a*(u*s-r*n))*e,f*e,-(d*(l*j-q*m)-c*(n*j-q*o)+a*(n*m-l*o))*e,(d*(t*j-p*m)-c*(u*j-p*o)+a*(u*m-t*o))*e,-(d*(t*q-p*l)-c*(u*q-p*n)+a*(u*l-t*n))*e,-i*e,(d*(l*k-s*m)-c*(n*k-s*o)+b*(n*m-l*o))*e,-(d*(t*k-r*m)-c*(u*k-r*o)+b*(u*m-t*o))*e,(d*(t*s-r*l)-c*(u*s-r*n)+b*(u*l-t*n))*e]);return this},multiply:function(v){var d=this.m[0],c=this.m[1],b=this.m[2],a=this.m[3],H=this.m[4],G=this.m[5],E=this.m[6],C=this.m[7],A=this.m[8],y=this.m[9],F=this.m[10],D=this.m[11],B=this.m[12],z=this.m[13],x=this.m[14],w=this.m[15],q=v.m[0],o=v.m[1],l=v.m[2],k=v.m[3],j=v.m[4],i=v.m[5],h=v.m[6],g=v.m[7],f=v.m[8],e=v.m[9],u=v.m[10],t=v.m[11],s=v.m[12],r=v.m[13],p=v.m[14],m=v.m[15];this.m=([d*q+c*j+b*f+a*s,d*o+c*i+b*e+a*r,d*l+c*h+b*u+a*p,d*k+c*g+b*t+a*m,H*q+G*j+E*f+C*s,H*o+G*i+E*e+C*r,H*l+G*h+E*u+C*p,H*k+G*g+E*t+C*m,A*q+y*j+F*f+D*s,A*o+y*i+F*e+D*r,A*l+y*h+F*u+D*p,A*k+y*g+F*t+D*m,B*q+z*j+x*f+w*s,B*o+z*i+x*e+w*r,B*l+z*h+x*u+w*p,B*k+z*g+x*t+w*m])},multiplyVector4:function(b){var a=this.m;return new Vector4(a[0]*b.x+a[1]*b.y+a[2]*b.z+a[3]*b.w,a[4]*b.x+a[5]*b.y+a[6]*b.z+a[7]*b.w,a[8]*b.x+a[9]*b.y+a[10]*b.z+a[11]*b.w,a[12]*b.x+a[13]*b.y+a[14]*b.z+a[15]*b.w)},toString:function(){var a=this.m;return a[0].toFixed(4)+", "+a[1].toFixed(4)+", "+a[2].toFixed(4)+", "+a[3].toFixed(4)+"\n"+a[4].toFixed(4)+", "+a[5].toFixed(4)+", "+a[6].toFixed(4)+", "+a[7].toFixed(4)+"\n"+a[8].toFixed(4)+", "+a[9].toFixed(4)+", "+a[10].toFixed(4)+", "+a[11].toFixed(4)+"\n"+a[12].toFixed(4)+", "+a[13].toFixed(4)+", "+a[14].toFixed(4)+", "+a[15].toFixed(4)}};function Matrix4o(m,k,i,g,f,e,d,c,b,a,p,o,n,l,j,h){if(h){this.m0=m;this.m1=k;this.m2=i;this.m3=g;this.m4=f;this.m5=e;this.m6=d;this.m7=c;this.m8=b;this.m9=a;this.m10=p;this.m11=o;this.m12=n;this.m13=l;this.m14=j;this.m15=h;return this}this.m0=1;this.m1=0;this.m2=0;this.m3=0;this.m4=0;this.m5=1;this.m6=0;this.m7=0;this.m8=0;this.m9=0;this.m10=1;this.m11=0;this.m12=0;this.m13=0;this.m14=0;this.m15=1;return this}Matrix4o.prototype={type:"Object",inverse:function(){var d=this.m0,c=this.m1,b=this.m2,a=this.m3,u=this.m4,t=this.m5,r=this.m6,p=this.m7,n=this.m8,l=this.m9,s=this.m10,q=this.m11,o=this.m12,m=this.m13,k=this.m14,j=this.m15,h=t*(s*j-q*k-r*(l*j-q*m)+p*(l*k-s*m)),g=u*(s*j-q*k)-r*(n*j-q*o)+p*(n*k-s*o),f=u*(l*j-q*m)-t*(n*j-q*o)+p*(n*m-l*o),i=u*(l*k-s*m)-t*(n*k-s*o)+r*(n*m-l*o),e=1/(d*h+c*g-b*f+a*i);this.m0=h*e;this.m1=-(c*(s*j-q*k)-b*(l*j-q*m)+a*(l*k-s*m))*e;this.m2=(c*(r*j-p*k)-b*(t*j-p*m)+a*(t*k-r*m))*e;this.m3=-(c*(r*q-p*s)-b*(t*q-p*l)+a*(t*s-r*l))*e;this.m4=-g*e;this.m5=(d*(s*j-q*k)-b*(n*j-q*o)+a*(n*k-s*o))*e;this.m6=-(d*(r*j-p*k)-b*(u*j-p*o)+a*(u*k-r*o))*e;this.m7=(d*(r*q-p*s)-b*(u*q-p*n)+a*(u*s-r*n))*e;this.m8=f*e;this.m9=-(d*(l*j-q*m)-c*(n*j-q*o)+a*(n*m-l*o))*e;this.m10=(d*(t*j-p*m)-c*(u*j-p*o)+a*(u*m-t*o))*e;this.m11=-(d*(t*q-p*l)-c*(u*q-p*n)+a*(u*l-t*n))*e;this.m12=-i*e;this.m13=(d*(l*k-s*m)-c*(n*k-s*o)+b*(n*m-l*o))*e;this.m14=-(d*(t*k-r*m)-c*(u*k-r*o)+b*(u*m-t*o))*e;this.m15=(d*(t*s-r*l)-c*(u*s-r*n)+b*(u*l-t*n))*e;return this},multiply:function(v){var d=this.m0,c=this.m1,b=this.m2,a=this.m3,H=this.m4,G=this.m5,E=this.m6,C=this.m7,A=this.m8,y=this.m9,F=this.m10,D=this.m11,B=this.m12,z=this.m13,x=this.m14,w=this.m15,q=v.m0,o=v.m1,l=v.m2,k=v.m3,j=v.m4,i=v.m5,h=v.m6,g=v.m7,f=v.m8,e=v.m9,u=v.m10,t=v.m11,s=v.m12,r=v.m13,p=v.m14,m=v.m15;this.m0=d*q+c*j+b*f+a*s;this.m1=d*o+c*i+b*e+a*r;this.m2=d*l+c*h+b*u+a*p;this.m3=d*k+c*g+b*t+a*m;this.m4=H*q+G*j+E*f+C*s;this.m5=H*o+G*i+E*e+C*r;this.m6=H*l+G*h+E*u+C*p;this.m7=H*k+G*g+E*t+C*m;this.m8=A*q+y*j+F*f+D*s;this.m9=A*o+y*i+F*e+D*r;this.m10=A*l+y*h+F*u+D*p;this.m11=A*k+y*g+F*t+D*m;this.m12=B*q+z*j+x*f+w*s;this.m13=B*o+z*i+x*e+w*r;this.m14=B*l+z*h+x*u+w*p},multiplyVector4:function(a){return new Vector4(this.m0*a.x+this.m1*a.y+this.m2*a.z+this.m3*a.w,this.m4*a.x+this.m5*a.y+this.m6*a.z+this.m7*a.w,this.m8*a.x+this.m9*a.y+this.m10*a.z+this.m11*a.w,this.m12*a.x+this.m13*a.y+this.m14*a.z+this.m15*a.w)},toString:function(){var a=this;return a.m0.toFixed(4)+", "+a.m1.toFixed(4)+", "+a.m2.toFixed(4)+", "+a.m3.toFixed(4)+"\n"+a.m4.toFixed(4)+", "+a.m5.toFixed(4)+", "+a.m6.toFixed(4)+", "+a.m7.toFixed(4)+"\n"+a.m8.toFixed(4)+", "+a.m9.toFixed(4)+", "+a.m10.toFixed(4)+", "+a.m11.toFixed(4)+"\n"+a.m12.toFixed(4)+", "+a.m13.toFixed(4)+", "+a.m14.toFixed(4)+", "+a.m15.toFixed(4)}};var Matrix4=(window.chrome)?Matrix4a:Matrix4o;Matrix4.Identity=function(){return new this(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)};Matrix4.CreateRotationX=function(b){var d=Math.cos(b);var a=Math.sin(b);return new this(1,0,0,0,0,d,-a,0,0,a,d,0,0,0,0,1)};Matrix4.CreateRotationY=function(b){var d=Math.cos(b);var a=Math.sin(b);return new this(d,0,a,0,0,1,0,0,-a,0,d,0,0,0,0,1)};Matrix4.CreateRotationZ=function(b){var d=Math.cos(b);var a=Math.sin(b);return new this(d,-a,0,0,a,d,0,0,0,0,1,0,0,0,0,1)};Matrix4.CreateTranslation=function(a,c,b){return new this(1,0,0,a,0,1,0,c,0,0,1,b,0,0,0,1)};Matrix4.CreateScale=function(a,c,b){return new this(a,0,0,0,0,c,0,0,0,0,b,0,0,0,0,1)};Matrix4.CreateRotationAroundAxis=function(g,j){var l=Math.sin(g);var e=Math.cos(g);var k=1-e,i=j.x,h=j.y,f=j.z;var a=i*i,d=h*h,b=f*f;return new this(k*a+e,k*i*h-l*f,k*i*f+l*h,0,k*i*h+l*f,k*d+e,k*h*f-l*i,0,k*i*f-l*h,k*h*f+l*i,k*b+e,0,0,0,0,1)};var N3D={Vector3:Vector3,Vector4:Vector4,Matrix4:Matrix4};