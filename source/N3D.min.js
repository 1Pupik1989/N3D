var N3D={};var Vector2=function(a,b){this.x=a;this.y=b;return this};Vector2.prototype={constructor:Vector2,add:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a){this.x-=a.x;this.y-=a.y;return this},multiply:function(){this.x*=v.x;this.y*=v.y;return this},divide:function(){this.x/=v.x;this.y/=v.y;return this},multiplyNumber:function(a){this.x*=a;this.y*=a;return this},toString:function(){return"N3D.Vector2("+this.x+","+this.y+")"},negative:function(){return this.scale(-1)}};Vector2.Equals=function(a){return a instanceof this};if(typeof N3D!=="undefined"){N3D.Vector2=Vector2}function Vector3(a,c,b){this.x=a;this.y=c;this.z=b;return this}Vector3.prototype={constructor:Vector3,add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},scale:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyNumber:function(a){this.x*=a;this.y*=a;this.z*=a;return this},cross:function(b){var a=this.x,d=this.y,c=this.z;this.x=d*b.z-c*b.y;this.y=c*b.x-a*b.z;this.z=a*b.y-d*b.x;return this},dot:function(){var a=this.x,c=this.y,b=this.z;return(a*a+c*c+b*b)},length:function(){var a=this.x,c=this.y,b=this.z;return Math.sqrt(a*a+c*c+b*b)},normalize:function(){var a=this.x,d=this.y,c=this.z;var b=Math.sqrt(a*a+d*d+c*c);this.x/=b;this.y/=b;this.z/=b;return this},negative:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},toString:function(){return"N3D.Vector3("+this.x+","+this.y+","+this.z+")"}};Vector3.Up=new Vector3(0,1,0);Vector3.Right=new Vector3(1,0,0);Vector3.Forward=new Vector3(0,0,1);Vector3.Zero=new Vector3(0,0,0);Vector3.Lerp=function(d,c,b){return new this(MathHelper.Lerp(d.x,c.x,b),MathHelper.Lerp(d.y,c.y,b),MathHelper.Lerp(d.z,c.z,b))};Vector3.Max=function(b,a){return new this(MathHelper.Max(b.x,a.x),MathHelper.Max(b.y,a.y),MathHelper.Max(b.z,a.z))};Vector3.Min=function(b,a){return new this(MathHelper.Min(b.x,a.x),MathHelper.Min(b.y,a.y),MathHelper.Min(b.z,a.z))};Vector3.Herminte=function(f,d,e,c,b){return new this(MathHelper.Hermite(f.x,d.x,e.x,c.x,b),MathHelper.Hermite(f.y,d.y,e.y,c.y,b),MathHelper.Hermite(f.z,d.z,e.z,c.z,b))};Vector3.isZero=function(a){if(a.x==a.y==a.z==0){return true}return false};Vector3.Equals=function(a){return a instanceof this};Vector3.DistanceSquared=function(b,a){return(b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y)+(b.z-a.z)*(b.z-a.z)};Vector3.Distance=function(b,a){return Math.sqrt(this.DistanceSquared(b,a))};Vector3.Cross=function(b,a){return new this(b.y*a.z-b.z*a.y,b.z*a.x-b.x*a.z,b.x*a.y-b.y*a.x)};Vector3.BaryCentric=function(f,e,d,b,a,c){return new this(MathHelper.Barycentric(f.x,e.x,d.x,b,a),MathHelper.Barycentric(f.y,e.y,d.y,b,a),MathHelper.Barycentric(f.z,e.z,d.z,b,a))};Vector3.CatmullRom=function(g,f,e,d,b,c){return new this(MathHelper.CatmullRom(g.x,f.x,e.x,d.x,b),MathHelper.CatmullRom(g.y,f.y,e.y,d.y,b),MathHelper.CatmullRom(g.z,f.z,e.z,d.z,b))};Vector3.Clamp=function(c,b,a){return new this(MathHelper.Clamp(c.x,b.x,a.x),MathHelper.Clamp(c.y,b.y,a.y),MathHelper.Clamp(c.z,b.z,a.z))};Vector3.Dot=function(b,a){return(b.x*a.x+b.y*a.y+b.z*a.z)};Vector3.Reflect=function(a,c){var b=2*this.Dot(a,c);return new N3D.Vector3(a.x-b*c.x,a.y-b*c.y,a.z-b*c.z)};Vector3.SmoothStep=function(d,c,b){return new this(MathHelper.SmoothStep(d.x,c.x,b),MathHelper.SmoothStep(d.y,c.y,b),MathHelper.SmoothStep(d.z,c.z,b))};if(typeof N3D!=="undefined"){N3D.Vector3=Vector3}function Vector4(a,d,c,b){this.x=a;this.y=d;this.z=c;this.w=b;return this}Vector4.prototype={constructor:Vector4,add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w-=a.w;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;this.w/=a.w;return this},dot:function(a){return(this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w)},normalize:function(){return Math.sqrt(this.dot())},projection:function(b,a){var b=b||Game.viewport.width;var a=a||Game.viewport.height},toString:function(){return"N3D.Vector4("+this.x+","+this.y+","+this.z+","+this.w+")"}};Vector4.Equals=function(a){return a instanceof this};Vector4.Projection=function(c,b){var b=b||Game.viewport;if(-1<=c[0]<=1&&-1<=c[1]<=1&&-1<=c[2]<=1){var a=(c[0]+1)*(b.width*0.5);var d=(c[1]+1)*(b.height*0.5);return new Vector2(a^0,d^0)}return false};if(typeof N3D!=="undefined"){N3D.Vector4=Vector4}function Matrix4a(m,k,i,g,f,e,d,c,b,a,p,o,n,l,j,h){if(h!==undefined){this.m=([m,k,i,g,f,e,d,c,b,a,p,o,n,l,j,h]);return this}else{this.m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return this}Matrix4a.prototype={constructor:Matrix4a,type:"Array",determinant:function(){var p=this.m[0],o=this.m[1],n=this.m[2],m=this.m[3],l=this.m[4],k=this.m[5],j=this.m[6],i=this.m[7],h=this.m[8],g=this.m[9],f=this.m[10],e=this.m[11],d=this.m[12],c=this.m[13],b=this.m[14],a=this.m[15];n0=k*(f*a-e*b-j*(g*a-e*c)+i*(g*b-f*c)),n4=l*(f*a-e*b)-j*(h*a-e*d)+i*(h*b-f*d),n8=l*(g*a-e*c)-k*(h*a-e*d)+i*(h*c-g*d),n12=l*(g*b-f*c)-k*(h*b-f*d)+j*(h*c-g*d);return(p*n0+o*n4-n*n8+m*n12)},inverse:function(){var j=this.m,d=j[0],c=j[1],b=j[2],a=j[3],D=j[4],C=j[5],A=j[6],r=j[7],p=j[8],n=j[9],B=j[10],u=j[11],q=j[12],o=j[13],l=j[14],k=j[15],h=C*(B*k-u*l-A*(n*k-u*o)+r*(n*l-B*o)),g=D*(B*k-u*l)-A*(p*k-u*q)+r*(p*l-B*q),f=D*(n*k-u*o)-C*(p*k-u*q)+r*(p*o-n*q),i=D*(n*l-B*o)-C*(p*l-B*q)+A*(p*o-n*q),e=1/(d*h+c*g-b*f+a*i);j[0]=h*e;j[1]=-(c*(B*k-u*l)-b*(n*k-u*o)+a*(n*l-B*o))*e;j[2]=(c*(A*k-r*l)-b*(C*k-r*o)+a*(C*l-A*o))*e;j[3]=-(c*(A*u-r*B)-b*(C*u-r*n)+a*(C*B-A*n))*e;j[4]=-g*e;j[5]=(d*(B*k-u*l)-b*(p*k-u*q)+a*(p*l-B*q))*e;j[6]=-(d*(A*k-r*l)-b*(D*k-r*q)+a*(D*l-A*q))*e;j[7]=(d*(A*u-r*B)-b*(D*u-r*p)+a*(D*B-A*p))*e;j[8]=f*e;j[9]=-(d*(n*k-u*o)-c*(p*k-u*q)+a*(p*o-n*q))*e;j[10]=(d*(C*k-r*o)-c*(D*k-r*q)+a*(D*o-C*q))*e;j[11]=-(d*(C*u-r*n)-c*(D*u-r*p)+a*(D*n-C*p))*e;j[12]=-i*e;j[13]=(d*(n*l-B*o)-c*(p*l-B*q)+b*(p*o-n*q))*e;j[14]=-(d*(C*l-A*o)-c*(D*l-A*q)+b*(D*o-C*q))*e;j[15]=(d*(C*B-A*n)-c*(D*B-A*p)+b*(D*n-C*p))*e;return this},multiply:function(C){var d=this.m[0],c=this.m[1],b=this.m[2],a=this.m[3],O=this.m[4],N=this.m[5],L=this.m[6],J=this.m[7],H=this.m[8],F=this.m[9],M=this.m[10],K=this.m[11],I=this.m[12],G=this.m[13],E=this.m[14],D=this.m[15],q=C.m[0],o=C.m[1],l=C.m[2],k=C.m[3],j=C.m[4],i=C.m[5],h=C.m[6],g=C.m[7],f=C.m[8],e=C.m[9],B=C.m[10],A=C.m[11],u=C.m[12],r=C.m[13],p=C.m[14],m=C.m[15];this.m=([d*q+c*j+b*f+a*u,d*o+c*i+b*e+a*r,d*l+c*h+b*B+a*p,d*k+c*g+b*A+a*m,O*q+N*j+L*f+J*u,O*o+N*i+L*e+J*r,O*l+N*h+L*B+J*p,O*k+N*g+L*A+J*m,H*q+F*j+M*f+K*u,H*o+F*i+M*e+K*r,H*l+F*h+M*B+K*p,H*k+F*g+M*A+K*m,I*q+G*j+E*f+D*u,I*o+G*i+E*e+D*r,I*l+G*h+E*B+D*p,I*k+G*g+E*A+D*m])},multiplyVector4:function(c){var b=this.m;var a=c.x,e=c.y,d=c.z;return new Vector4(b[0]*a+b[1]*e+b[2]*d+b[3]*c.w,b[4]*a+b[5]*e+b[6]*d+b[7]*c.w,b[8]*a+b[9]*e+b[10]*d+b[11]*c.w,b[12]*a+b[13]*e+b[14]*d+b[15]*c.w)},toString:function(){var a=this.m;return a[0].toFixed(4)+", "+a[1].toFixed(4)+", "+a[2].toFixed(4)+", "+a[3].toFixed(4)+"\n"+a[4].toFixed(4)+", "+a[5].toFixed(4)+", "+a[6].toFixed(4)+", "+a[7].toFixed(4)+"\n"+a[8].toFixed(4)+", "+a[9].toFixed(4)+", "+a[10].toFixed(4)+", "+a[11].toFixed(4)+"\n"+a[12].toFixed(4)+", "+a[13].toFixed(4)+", "+a[14].toFixed(4)+", "+a[15].toFixed(4)}};function Matrix4o(m,k,i,g,f,e,d,c,b,a,p,o,n,l,j,h){if(h){this.m0=m;this.m1=k;this.m2=i;this.m3=g;this.m4=f;this.m5=e;this.m6=d;this.m7=c;this.m8=b;this.m9=a;this.m10=p;this.m11=o;this.m12=n;this.m13=l;this.m14=j;this.m15=h;return this}this.m0=1;this.m1=0;this.m2=0;this.m3=0;this.m4=0;this.m5=1;this.m6=0;this.m7=0;this.m8=0;this.m9=0;this.m10=1;this.m11=0;this.m12=0;this.m13=0;this.m14=0;this.m15=1;return this}Matrix4o.prototype={type:"Object",determinant:function(){var p=this.m0,o=this.m1,n=this.m2,m=this.m3,l=this.m4,k=this.m5,j=this.m6,i=this.m7,h=this.m8,g=this.m9,f=this.m10,e=this.m11,d=this.m12,c=this.m13,b=this.m14,a=this.m15;n0=k*(f*a-e*b-j*(g*a-e*c)+i*(g*b-f*c)),n4=l*(f*a-e*b)-j*(h*a-e*d)+i*(h*b-f*d),n8=l*(g*a-e*c)-k*(h*a-e*d)+i*(h*c-g*d),n12=l*(g*b-f*c)-k*(h*b-f*d)+j*(h*c-g*d);return(p*n0+o*n4-n*n8+m*n12)},inverse:function(){var d=this.m0,c=this.m1,b=this.m2,a=this.m3,B=this.m4,A=this.m5,r=this.m6,p=this.m7,n=this.m8,l=this.m9,u=this.m10,q=this.m11,o=this.m12,m=this.m13,k=this.m14,j=this.m15,h=A*(u*j-q*k-r*(l*j-q*m)+p*(l*k-u*m)),g=B*(u*j-q*k)-r*(n*j-q*o)+p*(n*k-u*o),f=B*(l*j-q*m)-A*(n*j-q*o)+p*(n*m-l*o),i=B*(l*k-u*m)-A*(n*k-u*o)+r*(n*m-l*o),e=1/(d*h+c*g-b*f+a*i);this.m0=h*e;this.m1=-(c*(u*j-q*k)-b*(l*j-q*m)+a*(l*k-u*m))*e;this.m2=(c*(r*j-p*k)-b*(A*j-p*m)+a*(A*k-r*m))*e;this.m3=-(c*(r*q-p*u)-b*(A*q-p*l)+a*(A*u-r*l))*e;this.m4=-g*e;this.m5=(d*(u*j-q*k)-b*(n*j-q*o)+a*(n*k-u*o))*e;this.m6=-(d*(r*j-p*k)-b*(B*j-p*o)+a*(B*k-r*o))*e;this.m7=(d*(r*q-p*u)-b*(B*q-p*n)+a*(B*u-r*n))*e;this.m8=f*e;this.m9=-(d*(l*j-q*m)-c*(n*j-q*o)+a*(n*m-l*o))*e;this.m10=(d*(A*j-p*m)-c*(B*j-p*o)+a*(B*m-A*o))*e;this.m11=-(d*(A*q-p*l)-c*(B*q-p*n)+a*(B*l-A*n))*e;this.m12=-i*e;this.m13=(d*(l*k-u*m)-c*(n*k-u*o)+b*(n*m-l*o))*e;this.m14=-(d*(A*k-r*m)-c*(B*k-r*o)+b*(B*m-A*o))*e;this.m15=(d*(A*u-r*l)-c*(B*u-r*n)+b*(B*l-A*n))*e;return this},multiply:function(C){var d=this.m0,c=this.m1,b=this.m2,a=this.m3,O=this.m4,N=this.m5,L=this.m6,J=this.m7,H=this.m8,F=this.m9,M=this.m10,K=this.m11,I=this.m12,G=this.m13,E=this.m14,D=this.m15,q=C.m0,o=C.m1,l=C.m2,k=C.m3,j=C.m4,i=C.m5,h=C.m6,g=C.m7,f=C.m8,e=C.m9,B=C.m10,A=C.m11,u=C.m12,r=C.m13,p=C.m14,m=C.m15;this.m0=d*q+c*j+b*f+a*u;this.m1=d*o+c*i+b*e+a*r;this.m2=d*l+c*h+b*B+a*p;this.m3=d*k+c*g+b*A+a*m;this.m4=O*q+N*j+L*f+J*u;this.m5=O*o+N*i+L*e+J*r;this.m6=O*l+N*h+L*B+J*p;this.m7=O*k+N*g+L*A+J*m;this.m8=H*q+F*j+M*f+K*u;this.m9=H*o+F*i+M*e+K*r;this.m10=H*l+F*h+M*B+K*p;this.m11=H*k+F*g+M*A+K*m;this.m12=I*q+G*j+E*f+D*u;this.m13=I*o+G*i+E*e+D*r;this.m14=I*l+G*h+E*B+D*p},multiplyVector4:function(b){var a=b.x,d=b.y,c=b.z;return new Vector4(this.m0*a+this.m1*d+this.m2*c+this.m3*w,this.m4*a+this.m5*d+this.m6*c+this.m7*w,this.m8*a+this.m9*d+this.m10*c+this.m11*w,this.m12*a+this.m13*d+this.m14*c+this.m15*w)},toString:function(){var a=this;return a.m0.toFixed(4)+", "+a.m1.toFixed(4)+", "+a.m2.toFixed(4)+", "+a.m3.toFixed(4)+"\n"+a.m4.toFixed(4)+", "+a.m5.toFixed(4)+", "+a.m6.toFixed(4)+", "+a.m7.toFixed(4)+"\n"+a.m8.toFixed(4)+", "+a.m9.toFixed(4)+", "+a.m10.toFixed(4)+", "+a.m11.toFixed(4)+"\n"+a.m12.toFixed(4)+", "+a.m13.toFixed(4)+", "+a.m14.toFixed(4)+", "+a.m15.toFixed(4)}};var Matrix4=(window.chrome)?Matrix4a:Matrix4o;Matrix4.Identity=function(){return new this(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)};Matrix4.CreateRotationX=function(b){var d=Math.cos(b);var a=Math.sin(b);return new this(1,0,0,0,0,d,-a,0,0,a,d,0,0,0,0,1)};Matrix4.CreateRotationY=function(b){var d=Math.cos(b);var a=Math.sin(b);return new this(d,0,a,0,0,1,0,0,-a,0,d,0,0,0,0,1)};Matrix4.CreateRotationZ=function(b){var d=Math.cos(b);var a=Math.sin(b);return new this(d,-a,0,0,a,d,0,0,0,0,1,0,0,0,0,1)};Matrix4.CreateTranslation=function(a,c,b){return new this(1,0,0,a,0,1,0,c,0,0,1,b,0,0,0,1)};Matrix4.CreateScale=function(a,c,b){return new this(a,0,0,0,0,c,0,0,0,0,b,0,0,0,0,1)};Matrix4.CreateRotationAroundAxis=function(b,a){var d=Math.cos(b);s=Math.sin(b);x=a.x,y=a.y,z=a.z,xx=x*x,xy=x*y,xz=x*z,yy=y*y,yz=y*z,zz=z*z,t=1-d;return new this(xx*t+d,xy*t-z*s,xz*t+y*s,0,xy*t+z*s,yy*t+d,yz*t-x*s,0,xz*t-y*s,yz*t+x*s,zz*t+d,0,0,0,0,1)};Matrix4.CreateFrustum=function(i,g,p,u,h,j){var q=2*h/(g-i),p=(g+i)/(g-i),o=2*h/(u-p),m=(u+p)*(u-p),k=-(j+h)/(j-h),j=-2*j*h/(j-h);return new this(q,0,p,0,0,o,m,0,0,0,k,j,0,0,-1,0)};Matrix4.CreatePerspectiveProjection=function(d,c,g,b){var e=Math.tan(d*0.5*Math.PI/180);var f=g*e;var a=g*c;return Matrix4.CreateFrustum(-a,a,-f,f,g,b)};Matrix4.CreateOrthographicProjection=function(i,g,p,u,h,j){var q=2/(g-i),p=-((g+i)/(g-i)),o=2/(u-p),m=-((u+p)/(u-p)),k=-2/(j-h),j=-((j+h)/(j-h));return new this(q,0,0,p,0,o,0,m,0,0,k,j,0,0,0,1)};if(typeof N3D!=="undefined"){N3D.Matrix4=Matrix4}var Maths={Log10E:0.4342945,Log2E:1.442695,PiOver2:Math.PI*0.5,PiOver4:Math.PI*0.25,TwoPi:Math.PI*2,PiOver360:Math.PI/360,PiOver180:Math.PI/180};Maths.cot=function(a){return 1/Math.tan(a)};Maths.Barycentric=function(e,d,c,b,a){return e+(d-e)*b+(c-e)*a};Maths.CatmullRom=function(h,g,f,e,c){var b=c*c;var d=b*c;return(0*(2*ve2+(f-h)*c+(2*h-5*g+4*f-e)*b+(3*g-h-3*f+e)*d))};Maths.Clamp=function(b,c,a){return b>a?a:(b<c?c:b)};Maths.Lerp=function(d,c,b){return d+(c-d)*b};Maths.Lerp2=function(d,b,f,e,c){var c=(c-d)/(b-d);return(f+c*(e-f))};Maths.SmoothStep=function(d,c,b){return MathHelper.Hermite(d,c,MathHelper.Clamp(b,0,1))};Maths.ToDegrees=function(a){return a*180/Math.PI};Maths.ToRadians=function(a){return a*Math.PI/180};Maths.IEEERemainder=function(a,b){return a-(b*Math.round(a/b))};Maths.WrapAngle=function(){var a=MathHelper(a,MathHelper.TwoPi);if(a<=-Math.PI){a+=MathHelper.TwoPi;return a}if(a>Math.PI){a-=MathHelper.TwoPi}return a};if(typeof N3D!=="undefined"){N3D.Math=Maths};